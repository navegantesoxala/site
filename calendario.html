<!-- üëá C√ìDIGO COMPLETO ABAIXO üëá -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calend√°rio | Navegantes de Oxal√°</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    #filtroMes {
      margin: 1rem 0;
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    #calendario-dinamico {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    #calendario-dinamico th,
    #calendario-dinamico td {
  border: 1px solid #e0e0e0;
  padding: 12px;
  text-align: left;
  vertical-align: top;
  word-break: break-word;
    }

    #calendario-dinamico td:nth-child(4),
    #calendario-dinamico th:nth-child(4) {
    width: 50%;
    }


    #calendario-dinamico th {
      background-color: var(--primary-color);
      color: #fff;
    }

    #calendario-dinamico tr:nth-child(even):not(:first-child) {
      background-color: #fdfdfd;
    }

    #calendario-dinamico tr.destacado {
      background-color: #ffeeba !important;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <!-- An√∫ncio de Eventos -->
    <section class="evento-destaque">
      <div class="evento-banner">
        <h2>üç≠ Festa de Er√™ - 27 de Setembro!üéà</h2>
        <h2>üç¨ A partir das 20:00 hüç´</h2>
        <p>Junte-se a n√≥s nessa comemora√ß√£o cheia de alegria, doces, brincadeiras e muito ax√© em homenagem aos Er√™s!</p>
        <a href="calendario.html" class="evento-btn">Ver detalhes no calend√°rio</a>
      </div>
    </section>
    <!-- Fim do Bloco An√∫ncio de Eventos -->

    <nav>
      <div class="logo">
        <img src="logo_navegantes_oxala_melhorada.png" alt="Logo Navegantes de Oxal√°" />
        <span>Casa de Caridade<br>Navegantes de Oxal√°</span>
      </div>
      <button class="menu-toggle" aria-label="Abrir menu">&#9776;</button>
      <ul class="nav-links">
        <li><a href="index.html">In√≠cio</a></li>
        <li><a href="sobre.html">Hist√≥ria</a></li>
        <li><a href="acoes.html">A√ß√µes Sociais</a></li>
        <li><a href="calendario.html" class="active">Calend√°rio</a></li>
        <li><a href="mae-brenda.html">M√£e Brenda</a></li>
        <li><a href="doacoes.html">Doa√ß√µes</a></li>
        <li><a href="instagram.html">Instagram</a></li>
        <li><a href="contato.html">Contato</a></li>
      </ul>
    </nav>
  </header>

  <section class="hero" style="height: 40vh; background-image: url('fachada-terreiro.jpg');">
    <div class="hero-content">
      <h1>Calend√°rio de Giras e Eventos</h1>
      <p>Acompanhe nossa programa√ß√£o e participe conosco!</p>
    </div>
  </section>

  <section>
    <h2>Programa√ß√£o Mensal</h2>
    <p>Nossas giras s√£o momentos de celebra√ß√£o, f√© e aprendizado. Confira os hor√°rios regulares e os principais eventos anuais. Para atualiza√ß√µes em tempo real, siga-nos no Instagram @navegantesdeoxalase.</p>
    <p><strong>Todas as giras comunicadas s√£o abertas ao p√∫blico. Port√µes abertos a partir das 19:00 h, com in√≠cio da gira pontualmente √†s 20:00 horas.</strong></p>

    <!-- Filtro por m√™s -->
    <label for="filtroMes"><strong>Filtrar por m√™s:</strong></label>
    <select id="filtroMes">
      <option value="todos">Todos</option>
    </select>

    <!-- Tabela din√¢mica -->
    <table id="calendario-dinamico">
      <thead>
        <tr>
          <th>Data</th>
          <th>Hor√°rio</th>
          <th>Evento</th>
          <th>Descri√ß√£o</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="4">Carregando eventos...</td></tr>
      </tbody>
    </table>

    <p style="margin-top: 10px; font-size: 0.9rem; font-style: italic; color: var(--text-color);">
      Programa√ß√£o sujeita a altera√ß√µes. Para informa√ß√µes em tempo real, acesse o Instagram @navegantesdeoxalase
    </p>
  </section>

  <footer>
    <p>&copy; 2025 Casa de Caridade Navegantes de Oxal√° ‚Äî Todos os direitos reservados.</p>
    <p>Endere√ßo: R. S√£o Expedito, 161-93, Bairro In√°cio Barbosa, Aracaju/SE | CEP: 49041-023</p>
    <p>
      <a href="https://www.instagram.com/navegantesdeoxalase" target="_blank" rel="noopener">Siga-nos no Instagram</a>
      &nbsp;|&nbsp;
      <a href="mailto:navegantesdeoxalase@gmail.com">E-mail</a>
    </p>
  </footer>

  <!-- Scripts -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const toggle = document.querySelector('.menu-toggle');
      const navLinks = document.querySelector('.nav-links');

      toggle.addEventListener('click', () => {
        navLinks.classList.toggle('show');
      });
    });
  </script>

  <!-- Banner Auto-Oculto -->
  <script>
    const hoje = new Date();
    const fimEvento = new Date("2025-09-28");
    const banner = document.querySelector('.evento-destaque');
    if (banner && hoje > fimEvento) {
      banner.style.display = 'none';
    }
  </script>

  <!-- Script do calend√°rio din√¢mico -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tabela = document.querySelector('#calendario-dinamico tbody');
      const filtroMes = document.getElementById('filtroMes');
      const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQYNEBFT_jtZWlaV6_w_utihWvTz3kKQ72Dhr_5hOMzeU78uBZ3SIjOrHiycx7EIuH-_hli4oW6Fd9R/pub?gid=0&single=true&output=csv';

      const eventos = [];

      fetch(sheetURL)
  .then(res => res.text())
  .then(csv => {
    tabela.innerHTML = '';
    eventos.length = 0;

    function parseCSV(csv) {
  const lines = csv.trim().split('\n');
  const result = [];

  for (let i = 1; i < lines.length; i++) {
    const regex = /(?:\"([^\"]*)\")|([^,]+)/g;
    const values = [];
    let match;
    while ((match = regex.exec(lines[i]))) {
      values.push(match[1] || match[2]);
    }

    const [dataCompleta, hora, evento, descricao] = values;
    if (dataCompleta && hora && evento && descricao) {
      const dataLimpa = dataCompleta.replace(/["']/g, '').split(',')[1]?.trim() || dataCompleta;
      const dataObj = new Date(dataLimpa.split('/').reverse().join('-'));
      result.push({ data: dataLimpa, hora, evento, descricao, dataObj });
    }
  }

  return result;
}

// Carrega e processa
fetch(sheetURL)
  .then(res => res.text())
  .then(csv => {
    tabela.innerHTML = '';
    eventos.length = 0;

    const dados = parseCSV(csv);
    eventos.push(...dados);

    atualizarFiltroMes();
    renderizarTabela('todos');
  });


    atualizarFiltroMes();
    renderizarTabela('todos');
  })

        .catch(() => {
          tabela.innerHTML = '<tr><td colspan="4">Erro ao carregar eventos.</td></tr>';
        });

      filtroMes.addEventListener('change', () => {
        renderizarTabela(filtroMes.value);
      });

      function atualizarFiltroMes() {
        const mesesUnicos = new Set();
        eventos.forEach(ev => {
          const [dia, mes, ano] = ev.data.split('/');
          mesesUnicos.add(`${ano}-${mes}`);
        });

        const ordenado = Array.from(mesesUnicos).sort();
        ordenado.forEach(item => {
          const [ano, mes] = item.split('-');
          const nomeMes = new Date(`${ano}-${mes}-01`).toLocaleString('pt-BR', { month: 'long' });
          const option = document.createElement('option');
          option.value = item;
          option.textContent = `${nomeMes} de ${ano}`;
          filtroMes.appendChild(option);
        });
      }

      function renderizarTabela(mesSelecionado) {
        tabela.innerHTML = '';
        const hoje = new Date();
        const eventosFiltrados = eventos
          .filter(ev => {
            if (mesSelecionado === 'todos') return true;
            const [ano, mes] = mesSelecionado.split('-');
            return ev.dataObj.getFullYear() === parseInt(ano) && (ev.dataObj.getMonth() + 1) === parseInt(mes);
          })
          .sort((a, b) => a.dataObj - b.dataObj);

        if (eventosFiltrados.length === 0) {
          tabela.innerHTML = '<tr><td colspan="4">Nenhum evento para este m√™s.</td></tr>';
          return;
        }

        const proximo = eventosFiltrados.find(ev => ev.dataObj >= hoje);
        eventosFiltrados.forEach(ev => {
          const tr = document.createElement('tr');
          tr.classList.toggle('destacado', proximo && ev.data === proximo.data && ev.hora === proximo.hora);
          tr.innerHTML = `
            <td>${ev.data}</td>
            <td>${ev.hora}</td>
            <td>${ev.evento}${tr.classList.contains('destacado') ? ' üéØ' : ''}</td>
            <td>${ev.descricao}</td>
          `;
          tabela.appendChild(tr);
        });
      }
    });
  </script>
</body>
</html>
